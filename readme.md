![Screenshot.png](Screenshot.png)


## Broker Monitor
–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø–æ–∏—Å–∫–∞, –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –æ–±–ª–∏–≥–∞—Ü–∏–π —Å –∏—Å—Ç–æ—Ä–∏–µ–π —Å–æ–±—ã—Ç–∏–π.

## üìê–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- Backend: FastAPI, SQLAlchemy, Alembic, Pydantic, PostgreSQL
- Frontend: React (Create React App) c hot‚Äëreload
- –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è: Docker Compose

#### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- –ü–æ–∏—Å–∫ –æ–±–ª–∏–≥–∞—Ü–∏–π –ø–æ MOEX —á–µ—Ä–µ–∑ API, –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–∞—Ä—Å–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö —Å corpbonds.ru
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±–ª–∏–≥–∞—Ü–∏–π –≤ –ª–æ–∫–∞–ª—å–Ω—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
- –£–¥–∞–ª–µ–Ω–∏–µ –∏ –º–∞—Å—Å–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ –æ–±–ª–∏–≥–∞—Ü–∏—è–º
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –≥—Ä–∞—Ñ–∏–∫ —Ü–µ–Ω
- –õ–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Å–æ—Ö—Ä–∞–Ω—è–µ–º—ã–µ –≤ –±–∞–∑–µ

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (/.env)

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è        | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä          |
|------------|---------|----------------|
| DATABASE_URL       | DSN –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Postgres      | postgresql+asyncpg://bonds_user:secretpass@db:5432/bondsdb         |
| POSTGRES_USER | –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å Postgres | bonds_user |
| POSTGRES_PASSWORD | –ø–∞—Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | password |
| POSTGRES_DB | –ë–î –≤ Postgres | bondsdb |
| REACT_APP_API_URL       | –ë–∞–∑–æ–≤—ã–π URL API (–¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞)      | http://localhost:8010|
| DEV_MODE | —Ä–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ | true |
| CHOKIDAR_USEPOLLING | —Ä–µ–∂–∏–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ chokidar (–ø–µ—Ä–µ—á–∏—Ç—ã–≤–∞–Ω–∏–µ –∫–∞—Ç–∞–ª–æ–≥–æ–≤) | true |



3. –ó–∞–ø—É—Å—Ç–∏—Ç—å —á–µ—Ä–µ–∑ Docker Compose  `docker compose up --build -d`
4. –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ 
- Frontend: http://localhost:3000
- Backend Swagger UI: http://localhost:8010/docs


## üîπ –ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- –ë—Ä–∞—É–∑–µ—Ä ‚Üí Backend (8000) Backend –≤ dev‚Äë—Ä–µ–∂–∏–º–µ –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ frontend:3000 –¥–ª—è SPA‚Äë–º–∞—Ä—à—Ä—É—Ç–æ–≤ –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç API‚Äë–∑–∞–ø—Ä–æ—Å—ã.
- Backend ‚Üí Frontend –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏–∫–∏ –∏ —Å—Ç—Ä–∞–Ω–∏—Ü React dev‚Äë—Å–µ—Ä–≤–µ—Ä–∞.
- Backend ‚Üí DB –ó–∞–ø—Ä–æ—Å—ã –∫ PostgreSQL —á–µ—Ä–µ–∑ SQLAlchemy.
- Backend ‚Üí Alembic –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏.
- Frontend ‚Üí Browser –û—Ç–¥–∞—ë—Ç —Å–æ–±—Ä–∞–Ω–Ω—ã–π React‚Äë–∫–æ–¥ —Å hot‚Äëreload.



### üìä  API Endpoints
#### –û–±–ª–∏–≥–∞—Ü–∏–∏
- GET /bonds
- POST /bonds
- DELETE /bonds
- PUT /bonds
#### –ü–æ–∏—Å–∫
- GET /search_bonds?query={SECID –∏–ª–∏ —á–∞—Å—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è}
#### –õ–æ–≥–∏
- GET /logs
- POST /logs
### üîÑ –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö
| –¢–∞–±–ª–∏—Ü–∞          | –ö–ª—é—á–∏          |
|---------------------|----------------|
| Bond        | id, secid, isin, name, emitent, market, coupon, coupon_display, coupon_type, maturity_date, ytm, ytm_date, last_price, amortization, offer_date, akra_rating/forecast, raexpert_rating/forecast, nkr_rating/forecast, currency, currency_symbol, updated_at     |
| Price             | id, bond_id, date, value|
| EventLog           | id, timestamp, message         |

### –õ–æ–≥–∏ –∏ –æ—Ç–ª–∞–¥–∫–∞
FastAPI –ª–æ–≥–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ INFO

–î–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è DEBUG-—Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç httpcore/httpx –≤ main.py:
```python
logging.getLogger("httpcore").setLevel(logging.WARNING)
logging.getLogger("httpx").setLevel(logging.WARNING)
```
## üí° –°–æ–≤–µ—Ç—ã –ø–æ —Ä–∞–±–æ—Ç–µ
- –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ backend ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ—à—å —Ñ–∞–π–ª ‚Üí Uvicorn –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä.
- –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –º–æ–¥–µ–ª—è—Ö SQLAlchemy ‚Üí –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º —Å—Ç–∞—Ä—Ç–µ backend –º–∏–≥—Ä–∞—Ü–∏—è —Å–æ–∑–¥–∞—Å—Ç—Å—è –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (–Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –≤ backend/dev-entrypoint.sh).
- –ú–∏–≥—Ä–∞—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ backend/migrations (–º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä).
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è React –ø–æ–¥—Ö–≤–∞—Ç—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏ —Å–±–æ—Ä–∫–µ. –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è .env –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ npm start –∏–ª–∏ –ø–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä.
- CORS –Ω–∞ –±—ç–∫–µ–Ω–¥–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ main.py —á–µ—Ä–µ–∑ CORSMiddleware.


#### –∑–∞ backend/app/main.py –≤ –õ–° :)